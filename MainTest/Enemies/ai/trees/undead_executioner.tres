[gd_resource type="BehaviorTree" load_steps=25 format=3 uid="uid://drfs5irx3u084"]

[ext_resource type="Script" path="res://demo/ai/tasks/get_first_in_group.gd" id="1_qvoto"]
[ext_resource type="Script" path="res://demo/ai/tasks/pursue.gd" id="2_x5xpu"]
[ext_resource type="Script" path="res://demo/ai/tasks/face_target.gd" id="3_i5tkq"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_cc0db"]

[sub_resource type="BTConsolePrint" id="BTConsolePrint_psjkf"]
text = "Pause"

[sub_resource type="BBNode" id="BBNode_n5pg4"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_3ox1h"]
animation_player = SubResource("BBNode_n5pg4")
animation_name = &"Idle"
blend = 0.1

[sub_resource type="BTRandomWait" id="BTRandomWait_a2frv"]
min_duration = 0.5
max_duration = 0.7

[sub_resource type="BTSequence" id="BTSequence_arw5k"]
custom_name = "Pause before action"
children = [SubResource("BTConsolePrint_psjkf"), SubResource("BTPlayAnimation_3ox1h"), SubResource("BTRandomWait_a2frv")]

[sub_resource type="BTConsolePrint" id="BTConsolePrint_vbroy"]
text = "Chase"

[sub_resource type="BBNode" id="BBNode_n3b0s"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_wyt4w"]
animation_player = SubResource("BBNode_n3b0s")
animation_name = &"Idle"
blend = 0.1

[sub_resource type="BTAction" id="BTAction_qmol7"]
script = ExtResource("1_qvoto")
group = &"Player"
output_var = &"target"

[sub_resource type="BTAction" id="BTAction_tpgc2"]
script = ExtResource("2_x5xpu")
target_var = &"target"
speed_var = &"speed"
approach_distance = 10.0

[sub_resource type="BTTimeLimit" id="BTTimeLimit_fy6d0"]
time_limit = 3.0
children = [SubResource("BTAction_tpgc2")]

[sub_resource type="BTSequence" id="BTSequence_7cx58"]
custom_name = "Pursue player"
children = [SubResource("BTConsolePrint_vbroy"), SubResource("BTPlayAnimation_wyt4w"), SubResource("BTAction_qmol7"), SubResource("BTTimeLimit_fy6d0")]

[sub_resource type="BTConsolePrint" id="BTConsolePrint_ykyws"]
text = "Attack"

[sub_resource type="BTAction" id="BTAction_y611e"]
script = ExtResource("3_i5tkq")
target_var = &"target"

[sub_resource type="BTWait" id="BTWait_b6i3w"]
duration = 0.1

[sub_resource type="BBNode" id="BBNode_0pu6a"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_pg2rb"]
await_completion = 1.0
animation_player = SubResource("BBNode_0pu6a")
animation_name = &"Attacking"

[sub_resource type="BTAction" id="BTAction_jtub5"]
script = ExtResource("2_x5xpu")
target_var = &"target"
speed_var = &"speed"
approach_distance = 10.0

[sub_resource type="BTSequence" id="BTSequence_nfgnt"]
custom_name = "Melee attack"
children = [SubResource("BTConsolePrint_ykyws"), SubResource("BTAction_y611e"), SubResource("BTWait_b6i3w"), SubResource("BTPlayAnimation_pg2rb"), SubResource("BTAction_jtub5")]

[sub_resource type="BTSequence" id="BTSequence_o500g"]
children = [SubResource("BTSequence_arw5k"), SubResource("BTSequence_7cx58"), SubResource("BTSequence_nfgnt")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_cc0db")
root_task = SubResource("BTSequence_o500g")
